{  
    "Version":"2012-10-17",
    "Statement":[  
       {  
          "Sid":"AllowGroupToSeeBucketListInTheConsole",
          "Effect":"Allow",
          "Action":[  
             "s3:GetBucketLocation",
             "s3:ListAllMyBuckets"
          ],
          "Resource":[  
             "arn:aws:s3:::*"
          ]
       },
       {  
          "Sid":"AllowRootAndUserListingInBucket",
          "Effect":"Allow",
          "Action":[  
             "s3:ListBucket"
          ],
          "Resource":[  
             "arn:aws:s3:::traces"
          ],
          "Condition":{  
             "StringEquals":{  
                "s3:prefix":[  
                   "",
                   "users/"
                ]
             }
          }
       },
       {  
          "Sid":"AllowListingOfUserFolder",
          "Effect":"Allow",
          "Action":[  
             "s3:ListBucket"
          ],
          "Resource":[  
             "arn:aws:s3:::traces"
          ],
          "Condition":{  
             "StringLike":{  
                "s3:prefix":[  
                   "users/${jwt:sub}",
                   "users/${jwt:sub}/*"
                ]
             }
          }
       },
       {  
          "Sid":"AllowAllS3ActionsInUserFolder",
          "Effect":"Allow",
          "Action":[  
             "s3:*"
          ],
          "Resource":[  
             "arn:aws:s3:::traces/users/${jwt:sub}/*"
          ]
       }
    ]
 }